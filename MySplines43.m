%x = [-3 -1 0 2 7]
%y = [1.6 3.6 4.4 3.4 2.2]
%Para una funcion cubica tenemos S(x) = a + b*x + c*x^2 +d*x^3

clc 
hold on

A = [1,-3, 9, -27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     1,-1, 1,-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 1,-1, 1,-1, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 4, 8, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 4, 8; 
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 7,49, 343;
     
     0, 1, -2, 3 0, -1, 2, -3 , 0, 0, 0, 0, 0, 0,0, 0;
     0, 0, 0, 0, 0, 1, 0, 0, 0, -1, 0, 0 0, 0, 0, 0;              
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 4, 12, 0 -1, -4, -12;   
     
     0, 0, 2, -6, 0, 0, -2, 6, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 2, 0,  0, 0, -2, 0,  0, 0, 0, 0; 
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 12, 0, 0, -2, -12;
     
     0, 0, 2, -18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 42];
   
B = [1.6; 
    3.6; 
    3.6; 
    4.4; 
    4.4; 
    3.4; 
    3.4; 
    2.2; 
    0; 
    0; 
    0; 
    0; 
    0; 
    0; 
    0; 
    0];

S = (A^-1)*B

x1 = linspace(-3,-1,100);
x2 = linspace(-1,0,100);
x3 = linspace(0,2,100);
x4 = linspace(2,7,100);

S1 = S(1) + S(2)*x1  + S(3)*x1.^2  + S(4)*x1.^3;
S2 = S(5) + S(6)*x2  + S(7)*x2.^2  + S(8)*x2.^3;
S3 = S(9) + S(10)*x3 + S(11)*x3.^2 + S(12)*x3.^3;
S4 = S(13)+ S(14)*x4 + S(15)*x4.^2 + S(16)*x4.^3;

plot(x1,S1)
plot(x2,S2)
plot(x3,S3)
plot(x4,S4)
legend('S_1(x)','S_2(x)', 'S_3(x)','S_4(x)')

